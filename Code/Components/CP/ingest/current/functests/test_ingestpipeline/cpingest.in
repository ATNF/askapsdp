#
# Central Processor Ingest Pipeline Configuration
#

#
#  Observation details
#
sbid                        = 0
targets                     = [src1, src2]

target.src1.field_name      = test-field1
target.src1.field_direction = [12h30m00.000, -45d00m00.000, J2000]
target.src1.corrmode        = standard

target.src2.field_name      = test-field1
target.src2.field_direction = [12h30m00.000, -45d00m00.000, J2000]
target.src2.corrmode        = standard

# Array Name
array.name                  = ASKAP

# TOS metadata topic
metadata.topic              = metadata

#
# Feed Configurations
#
feeds.n_feeds               = 9

feeds.spacing               = 1deg

feeds.feed0                 = [0.0, 0.0]
feeds.feed1                 = [0.0, 0.0]
feeds.feed2                 = [0.0, 0.0]
feeds.feed3                 = [0.0, 0.0]
feeds.feed4                 = [0.0, 0.0]
feeds.feed5                 = [0.0, 0.0]
feeds.feed6                 = [0.0, 0.0]
feeds.feed7                 = [0.0, 0.0]
feeds.feed8                 = [0.0, 0.0]

#
# Antennas
#
antennas                = [ant1, ant3, ant6, ant8, ant9, ant15]

# Common to all antennas
antenna.ant.diameter    = 12m
antenna.ant.mount       = equatorial

# Per antenna config
antenna.ant1.name       = ak01
antenna.ant1.location   = [116.6314242861317, -26.697000722524, 360.990124660544]

antenna.ant3.name       = ak03
antenna.ant3.location   = [116.6317858746065, -26.69693403662801, 360.4301465414464]

antenna.ant6.name       = ak06
antenna.ant6.location   = [116.6327911957065, -26.69599302652372, 358.7396716130897]

antenna.ant8.name       = ak08
antenna.ant8.location   = [116.6310382605877, -26.69915356409521, 362.0615070033818]

antenna.ant9.name       = ak09
antenna.ant9.location   = [116.6289723379451, -26.69599760606219, 361.1683603106067]

antenna.ant15.name      = ak15
antenna.ant15.location  = [116.6239853521759, -26.69841096756231, 356.8405737774447]


#
# Baseline mapping:
# Used for mapping from baselineid to antenna1/antenna2/polarisation product
# Mapping is from baselineid to (ant1, ant2,  product)
#
baselinemap.baselineids            = [0..77]

# This maps the antenna indexes (used below) to antenna names
baselinemap.antennaidx = [ak06, ak01, ak03, ak15, ak08, ak09]

baselinemap.0                      = [0, 0, XX]
baselinemap.1                      = [0, 0, XY]
baselinemap.2                      = [0, 0, YY]

baselinemap.3                      = [0, 1, XX]
baselinemap.4                      = [0, 1, XY]
baselinemap.5                      = [0, 1, YX]
baselinemap.6                      = [0, 1, YY]

baselinemap.7                      = [0, 2, XX]
baselinemap.8                      = [0, 2, XY]
baselinemap.9                      = [0, 2, YX]
baselinemap.10                     = [0, 2, YY]

baselinemap.11                     = [0, 3, XX]
baselinemap.12                     = [0, 3, XY]
baselinemap.13                     = [0, 3, YX]
baselinemap.14                     = [0, 3, YY]

baselinemap.15                     = [0, 4, XX]
baselinemap.16                     = [0, 4, XY]
baselinemap.17                     = [0, 4, YX]
baselinemap.18                     = [0, 4, YY]

baselinemap.19                     = [0, 5, XX]
baselinemap.20                     = [0, 5, XY]
baselinemap.21                     = [0, 5, YX]
baselinemap.22                     = [0, 5, YY]

baselinemap.23                     = [1, 1, XX]
baselinemap.24                     = [1, 1, XY]
baselinemap.25                     = [1, 1, YY]

baselinemap.26                     = [1, 2, XX]
baselinemap.27                     = [1, 2, XY]
baselinemap.28                     = [1, 2, YX]
baselinemap.29                     = [1, 2, YY]

baselinemap.30                     = [1, 3, XX]
baselinemap.31                     = [1, 3, XY]
baselinemap.32                     = [1, 3, YX]
baselinemap.33                     = [1, 3, YY]

baselinemap.34                     = [1, 4, XX]
baselinemap.35                     = [1, 4, XY]
baselinemap.36                     = [1, 4, YX]
baselinemap.37                     = [1, 4, YY]

baselinemap.38                     = [1, 5, XX]
baselinemap.39                     = [1, 5, XY]
baselinemap.40                     = [1, 5, YX]
baselinemap.41                     = [1, 5, YY]

baselinemap.42                     = [2, 2, XX]
baselinemap.43                     = [2, 2, XY]
baselinemap.44                     = [2, 2, YY]

baselinemap.45                     = [2, 3, XX]
baselinemap.46                     = [2, 3, XY]
baselinemap.47                     = [2, 3, YX]
baselinemap.48                     = [2, 3, YY]

baselinemap.49                     = [2, 4, XX]
baselinemap.50                     = [2, 4, XY]
baselinemap.51                     = [2, 4, YX]
baselinemap.52                     = [2, 4, YY]

baselinemap.53                     = [2, 5, XX]
baselinemap.54                     = [2, 5, XY]
baselinemap.55                     = [2, 5, YX]
baselinemap.56                     = [2, 5, YY]

baselinemap.57                     = [3, 3, XX]
baselinemap.58                     = [3, 3, XY]
baselinemap.59                     = [3, 3, YY]

baselinemap.60                     = [3, 4, XX]
baselinemap.61                     = [3, 4, XY]
baselinemap.62                     = [3, 4, YX]
baselinemap.63                     = [3, 4, YY]

baselinemap.64                     = [3, 5, XX]
baselinemap.65                     = [3, 5, XY]
baselinemap.66                     = [3, 5, YX]
baselinemap.67                     = [3, 5, YY]

baselinemap.68                     = [4, 4, XX]
baselinemap.69                     = [4, 4, XY]
baselinemap.70                     = [4, 4, YY]

baselinemap.71                     = [4, 5, XX]
baselinemap.72                     = [4, 5, XY]
baselinemap.73                     = [4, 5, YX]
baselinemap.74                     = [4, 5, YY]

baselinemap.75                     = [5, 5, XX]
baselinemap.76                     = [5, 5, XY]
baselinemap.77                     = [5, 5, YY]

#
# Correlator mode(s)
#
correlator.modes                        = [standard]

correlator.mode.standard.chan_width     = 18.518518kHz
correlator.mode.standard.interval       = 5000000
correlator.mode.standard.n_chan         = 16416
correlator.mode.standard.stokes         = [XX, XY, YX, YY]


#
# Metadata topic config
#
metadata_source.ice.locator_host        = localhost
metadata_source.ice.locator_port        = 4061
metadata_source.icestorm.topicmanager   = IceStorm/TopicManager@IceStorm.TopicManager

#
# Monitoring Data Publisher Configuration
#
monitoring.enabled                      = true
monitoring.ice.locator_host             = localhost
monitoring.ice.locator_port             = 4061
monitoring.servicename                  = MoniCAService@MoniCAAdminAdapter

#
# Task List
#
tasks.tasklist                          = [MergedSource, CalcUVWTask, ChannelAvgTask, MSSink]

#
# MergedSource
#
tasks.MergedSource.type                             = MergedSource
tasks.MergedSource.params.beammap                   = "1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8" 
tasks.MergedSource.params.vis_source.port           = 3000
tasks.MergedSource.params.vis_source.buffer_size    = 44928

# Number of channels a given ingest process is meant to receive/process
tasks.MergedSource.params.n_channels.0              = 16416

#
# CalcUVWTask
#
tasks.CalcUVWTask.type                  = CalcUVWTask

#
# ChannelAvgTask
#
tasks.ChannelAvgTask.type               = ChannelAvgTask
tasks.ChannelAvgTask.params.averaging   = 54

#
# MSSink
#
tasks.MSSink.type                       = MSSink
tasks.MSSink.params.filename            = ingest_test%w.ms
tasks.MSSink.params.stman.bucketsize    = 65536
tasks.MSSink.params.stman.tilencorr     = 4
tasks.MSSink.params.stman.tilenchan     = 1026
